version: "3.1"

actions:
  - action_check_sufficient_funds
  - action_validate_recipient
slots:
  recipient:
    type: text
    mappings:
      - type: from_llm
  amount:
    type: float
    mappings:
      - type: from_llm
  final_confirmation:
    type: bool
    mappings:
      - type: from_llm
  has_sufficient_funds:
    type: bool
    mappings:
      - type: controlled
  recipient_exists:
    type: bool
    mappings:
      - type: controlled
responses:
  utter_ask_recipient:
    - text: "To who?"
      metadata:
        rephrase: True   
  utter_change_topic:
    - text: "Is there anything else I can help you with?"
  utter_insufficient_funds:
    - text: "You don't have enough money."
      metadata:
        rephrase: True          

  utter_recipient_not_found:
    - text: "I don't have {recipient} in my list of recipients."
      metadata:
        rephrase: True

  utter_ask_amount:
    - text: "How much?"
      metadata:
        rephrase: True
  utter_ask_final_confirmation:
    - text: "Please confirm: you want to transfer {amount} to {recipient}? Please answer yes or no."
      metadata:
        rephrase: True
        llm_prompt: |
          Ask the user everytime to confirm whether they want to proceed with the transfer.
          Do not assume confirmation from previous messages.
          Wait for explicit yes/no response.
  utter_transfer_cancelled:
    - text: "Your transfer has been cancelled."
      metadata:
        rephrase: True

  utter_transfer_complete:
    - text: "I've send {amount} to {recipient}. Do you want to send money to someone else?"
      metadata:
        rephrase: True

  utter_free_chitchat_response:
    - text: "placeholder"
      metadata:
        rephrase: True
        rephrase_prompt: |
          The following is a conversation with an AI assistant built with Rasa.
          The assistant helps the user transfer money.
          The assistant is efficient, precise and professional.
          No samll talk or chit-chat focus on completing the talk quickly and accurately.
          Context / previous conversation with the user:
          {{history}}
          {{current_input}}
          Suggested AI Response: